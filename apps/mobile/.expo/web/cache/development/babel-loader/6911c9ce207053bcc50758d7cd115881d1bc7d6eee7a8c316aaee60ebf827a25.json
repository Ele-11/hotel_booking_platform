{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from 'react';\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { Calendar } from 'react-native-calendars';\nimport { styles } from \"./index.styles\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar getWeekDay = function getWeekDay(dateString) {\n  var weeks = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];\n  return weeks[new Date(dateString).getDay()];\n};\nvar formatDateDisplay = function formatDateDisplay(dateString) {\n  var _dateString$split = dateString.split('-'),\n    _dateString$split2 = _slicedToArray(_dateString$split, 3),\n    _ = _dateString$split2[0],\n    m = _dateString$split2[1],\n    d = _dateString$split2[2];\n  return m + \"\\u6708\" + d + \"\\u65E5\";\n};\nvar Calendar_My = function Calendar_My(_ref) {\n  var visible = _ref.visible,\n    onClose = _ref.onClose,\n    onConfirm = _ref.onConfirm;\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    startDate = _useState2[0],\n    setStartDate = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    endDate = _useState4[0],\n    setEndDate = _useState4[1];\n  var _useState5 = useState({}),\n    _useState6 = _slicedToArray(_useState5, 2),\n    markedDates = _useState6[0],\n    setMarkedDates = _useState6[1];\n  var onDayPress = function onDayPress(day) {\n    var dateString = day.dateString;\n    if (!startDate || startDate && endDate) {\n      setStartDate(dateString);\n      setEndDate('');\n      setMarkedDates(_defineProperty({}, dateString, {\n        startingDay: true,\n        color: '#007AFF',\n        textColor: 'white'\n      }));\n    } else {\n      if (dateString <= startDate) {\n        setStartDate(dateString);\n        return;\n      }\n      setEndDate(dateString);\n      var newMarked = {};\n      var curr = new Date(startDate);\n      var end = new Date(dateString);\n      while (curr <= end) {\n        var str = curr.toISOString().split('T')[0];\n        if (str === startDate) {\n          newMarked[str] = {\n            startingDay: true,\n            color: '#007AFF',\n            textColor: 'white'\n          };\n        } else if (str === dateString) {\n          newMarked[str] = {\n            endingDay: true,\n            color: '#007AFF',\n            textColor: 'white'\n          };\n        } else {\n          newMarked[str] = {\n            color: '#EAF2FF',\n            textColor: '#007AFF'\n          };\n        }\n        curr.setDate(curr.getDate() + 1);\n      }\n      setMarkedDates(newMarked);\n      var nights = Math.ceil((end.getTime() - new Date(startDate).getTime()) / (1000 * 60 * 60 * 24));\n      setTimeout(function () {\n        onConfirm({\n          startStr: startDate,\n          startDisplay: formatDateDisplay(startDate),\n          startWeek: getWeekDay(startDate),\n          endStr: dateString,\n          endDisplay: formatDateDisplay(dateString),\n          endWeek: getWeekDay(dateString),\n          nights: nights\n        });\n      }, 300);\n    }\n  };\n  return _jsx(Modal, {\n    visible: visible,\n    animationType: \"slide\",\n    transparent: false,\n    children: _jsxs(View, {\n      style: {\n        flex: 1,\n        backgroundColor: '#fff',\n        paddingTop: Platform.OS === 'ios' ? 50 : 20\n      },\n      children: [_jsxs(View, {\n        style: styles.modalHeader,\n        children: [_jsx(TouchableOpacity, {\n          onPress: onClose,\n          children: _jsx(Text, {\n            style: {\n              color: '#666',\n              fontSize: 16\n            },\n            children: \"\\u53D6\\u6D88\"\n          })\n        }), _jsx(Text, {\n          style: styles.modalTitle,\n          children: \"\\u9009\\u62E9\\u5165\\u79BB\\u65E5\\u671F\"\n        }), _jsx(View, {\n          style: {\n            width: 40\n          }\n        })]\n      }), _jsx(Calendar, {\n        markingType: 'period',\n        markedDates: markedDates,\n        onDayPress: onDayPress,\n        minDate: new Date().toISOString().split('T')[0],\n        theme: {\n          selectedDayBackgroundColor: '#007AFF',\n          todayTextColor: '#007AFF',\n          arrowColor: '#007AFF'\n        }\n      })]\n    })\n  });\n};\nexport default Calendar_My;","map":{"version":3,"names":["React","useState","Modal","Platform","Text","TouchableOpacity","View","Calendar","styles","jsx","_jsx","jsxs","_jsxs","getWeekDay","dateString","weeks","Date","getDay","formatDateDisplay","_dateString$split","split","_dateString$split2","_slicedToArray","_","m","d","Calendar_My","_ref","visible","onClose","onConfirm","_useState","_useState2","startDate","setStartDate","_useState3","_useState4","endDate","setEndDate","_useState5","_useState6","markedDates","setMarkedDates","onDayPress","day","_defineProperty","startingDay","color","textColor","newMarked","curr","end","str","toISOString","endingDay","setDate","getDate","nights","Math","ceil","getTime","setTimeout","startStr","startDisplay","startWeek","endStr","endDisplay","endWeek","animationType","transparent","children","style","flex","backgroundColor","paddingTop","OS","modalHeader","onPress","fontSize","modalTitle","width","markingType","minDate","theme","selectedDayBackgroundColor","todayTextColor","arrowColor"],"sources":["F:/hotel_booking_platform/apps/mobile/src/components/Calendar_My/index.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Modal, Platform, Text, TouchableOpacity, View } from 'react-native';\r\nimport { Calendar } from 'react-native-calendars';\r\nimport { styles } from './index.styles';\r\n\r\n// 辅助函数：获取周几\r\nconst getWeekDay = (dateString: string) => {\r\n    const weeks = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];\r\n    return weeks[new Date(dateString).getDay()];\r\n};\r\n\r\n// 辅助函数：格式化显示 (05月01日)\r\nconst formatDateDisplay = (dateString: string) => {\r\n    const [_, m, d] = dateString.split('-');\r\n    return `${m}月${d}日`;\r\n};\r\n\r\ninterface CalendarProps {\r\n    visible: boolean;\r\n    onClose: () => void;\r\n    onConfirm: (data: any) => void;\r\n}\r\n\r\nconst Calendar_My = ({ visible, onClose, onConfirm }: CalendarProps) => {\r\n    const [startDate, setStartDate] = useState('');\r\n    const [endDate, setEndDate] = useState('');\r\n    const [markedDates, setMarkedDates] = useState<any>({});\r\n\r\n    const onDayPress = (day: any) => {\r\n        const dateString = day.dateString;\r\n\r\n        if (!startDate || (startDate && endDate)) {\r\n            // 选择开始日期\r\n            setStartDate(dateString);\r\n            setEndDate('');\r\n            setMarkedDates({\r\n                [dateString]: { startingDay: true, color: '#007AFF', textColor: 'white' }\r\n            });\r\n        } else {\r\n            // 选择结束日期\r\n            if (dateString <= startDate) {\r\n                setStartDate(dateString); // 如果选的比开始早，重置开始\r\n                return;\r\n            }\r\n\r\n            setEndDate(dateString);\r\n            const newMarked: any = {};\r\n            let curr = new Date(startDate);\r\n            const end = new Date(dateString);\r\n\r\n            // 循环生成中间高亮范围\r\n            while (curr <= end) {\r\n                const str = curr.toISOString().split('T')[0];\r\n                if (str === startDate) {\r\n                    newMarked[str] = { startingDay: true, color: '#007AFF', textColor: 'white' };\r\n                } else if (str === dateString) {\r\n                    newMarked[str] = { endingDay: true, color: '#007AFF', textColor: 'white' };\r\n                } else {\r\n                    newMarked[str] = { color: '#EAF2FF', textColor: '#007AFF' }; // 中间淡蓝色\r\n                }\r\n                curr.setDate(curr.getDate() + 1);\r\n            }\r\n            setMarkedDates(newMarked);\r\n\r\n            // 计算晚数并回传给主页\r\n            const nights = Math.ceil((end.getTime() - new Date(startDate).getTime()) / (1000 * 60 * 60 * 24));\r\n\r\n            // 延迟关闭，让用户看一眼选中效果\r\n            setTimeout(() => {\r\n                onConfirm({\r\n                    startStr: startDate,\r\n                    startDisplay: formatDateDisplay(startDate),\r\n                    startWeek: getWeekDay(startDate),\r\n                    endStr: dateString,\r\n                    endDisplay: formatDateDisplay(dateString),\r\n                    endWeek: getWeekDay(dateString),\r\n                    nights\r\n                });\r\n            }, 300);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Modal visible={visible} animationType=\"slide\" transparent={false}>\r\n            <View style={{ flex: 1, backgroundColor: '#fff', paddingTop: Platform.OS === 'ios' ? 50 : 20 }}>\r\n                <View style={styles.modalHeader}>\r\n                    <TouchableOpacity onPress={onClose}>\r\n                        <Text style={{ color: '#666', fontSize: 16 }}>取消</Text>\r\n                    </TouchableOpacity>\r\n                    <Text style={styles.modalTitle}>选择入离日期</Text>\r\n                    <View style={{ width: 40 }} />\r\n                </View>\r\n\r\n                <Calendar\r\n                    markingType={'period'}\r\n                    markedDates={markedDates}\r\n                    onDayPress={onDayPress}\r\n                    minDate={new Date().toISOString().split('T')[0]}\r\n                    theme={{\r\n                        selectedDayBackgroundColor: '#007AFF',\r\n                        todayTextColor: '#007AFF',\r\n                        arrowColor: '#007AFF',\r\n                    }}\r\n                />\r\n            </View>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default Calendar_My;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}